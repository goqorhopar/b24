# Инструкция по авторизации Meeting Bot

## Обзор

Meeting Bot теперь поддерживает автоматическую авторизацию на всех платформах. Это позволяет боту присоединяться к закрытым встречам без необходимости ручного входа каждый раз.

## Поддерживаемые платформы

- ✅ **Google Meet** - автоматический вход через Google аккаунт
- ✅ **Zoom** - авторизация через Zoom аккаунт  
- ✅ **Яндекс Телемост** - вход через Яндекс аккаунт
- ✅ **Контур.Толк** - авторизация через Контур
- ✅ **Microsoft Teams** - вход через Microsoft аккаунт

## Пошаговая инструкция

### Шаг 1: Первоначальная авторизация

1. **Запустите скрипт авторизации:**
   ```bash
   python auth_platforms.py
   ```

2. **Выберите опцию 1** - "Полная авторизация на всех платформах"

3. **Выполните вход на каждой платформе:**
   - Откроется браузер
   - Войдите в свой аккаунт на каждой платформе
   - Пройдите двухфакторную аутентификацию если требуется
   - Дождитесь полной загрузки главной страницы

### Шаг 2: Проверка сохраненных данных

После завершения авторизации будут созданы файлы:
- `cookies.json` - cookies для Playwright
- `selenium_cookies.json` - cookies для Selenium  
- `storage.json` - данные sessionStorage и localStorage

### Шаг 3: Тестирование

1. **Запустите тест:**
   ```bash
   python auth_platforms.py
   ```

2. **Выберите опцию 2** - "Тестирование сохраненных данных"

3. **Проверьте результат** - должно появиться сообщение об успешной авторизации

### Шаг 4: Развертывание на сервере

1. **Скопируйте файлы на сервер:**
   ```bash
   scp cookies.json selenium_cookies.json storage.json user@server:/path/to/bot/
   ```

2. **Убедитесь, что файлы находятся в рабочей директории бота**

3. **Запустите бота** - он автоматически будет использовать сохраненные данные

## Использование в коде

### Автоматическое применение авторизации

Бот автоматически применяет сохраненные данные при запуске:

```python
# В meeting-bot.py
auth_loader = get_auth_loader()
auth_status = auth_loader.get_auth_status()
print(f"Статус авторизации: {auth_status}")

# Автоматическое применение cookies и storage
if auth_loader.setup_authenticated_driver(driver):
    print("✅ Драйвер настроен с авторизацией")
```

### Проверка статуса авторизации

```python
from load_auth_data import get_auth_loader

auth_loader = get_auth_loader()
status = auth_loader.get_auth_status()
print(status)  # "✅ Полная авторизация доступна"
```

## Устранение проблем

### Проблема: "Авторизация не настроена"

**Решение:**
1. Убедитесь, что файлы `cookies.json`, `selenium_cookies.json`, `storage.json` существуют
2. Проверьте права доступа к файлам
3. Перезапустите авторизацию

### Проблема: "Требуется повторная авторизация"

**Причины:**
- Cookies истекли (обычно через 30 дней)
- Изменились настройки безопасности аккаунта
- Платформа обновила систему авторизации

**Решение:**
1. Запустите `python auth_platforms.py` заново
2. Выполните повторную авторизацию
3. Обновите файлы на сервере

### Проблема: Бот не может присоединиться к закрытой встрече

**Проверьте:**
1. Статус авторизации: `python -c "from load_auth_data import get_auth_loader; print(get_auth_loader().get_auth_status())"`
2. Логи бота на предмет сообщений об авторизации
3. Актуальность cookies (дата создания файлов)

## Безопасность

### Важные моменты:

1. **Файлы cookies содержат чувствительные данные** - не передавайте их третьим лицам
2. **Регулярно обновляйте авторизацию** - cookies имеют срок действия
3. **Используйте безопасные каналы** для передачи файлов на сервер
4. **Ограничьте доступ** к файлам авторизации на сервере

### Рекомендации:

- Создавайте резервные копии файлов авторизации
- Мониторьте логи на предмет ошибок авторизации
- Настройте автоматическое обновление cookies (планируется в будущих версиях)

## Обновление авторизации

### Когда обновлять:

- При изменении паролей
- При включении/отключении двухфакторной аутентификации
- При появлении ошибок авторизации
- Раз в месяц (профилактически)

### Как обновить:

1. Запустите `python auth_platforms.py`
2. Выберите опцию 1
3. Выполните повторную авторизацию
4. Обновите файлы на сервере

## Поддержка

При возникновении проблем:

1. Проверьте логи бота
2. Запустите тест авторизации
3. Проверьте актуальность файлов cookies
4. При необходимости выполните повторную авторизацию

---

**Примечание:** Авторизация значительно повышает успешность присоединения к встречам, особенно к закрытым или требующим входа в аккаунт.
